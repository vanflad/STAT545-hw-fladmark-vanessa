---
title: "hw05"
output: github_document
---

# Homework 5

## October 20th, 2017

### Factor management

**Load the necessary libraries**, with suppresed messages:

```{r Load libraries}
#suppress annoying start up message
suppressPackageStartupMessages(library(tidyverse))

#working with gapminder for this homework
library(gapminder)

#installed with tidyverse but needs to be loaded separately
library(forcats)
```

***

**Filter the gapminder data** to remove observations associated with the continent of Oceania:

```{r Drop Oceania} 
#filter data
newgap <- filter(gapminder, continent != "Oceania")

#check Oceania values
which(newgap$continent=="Oceania")

#check the levels
levels(newgap$continent)
```

Filter out Oceania, then check to see if it worked, we can see there are now 0 Oceania values but it remains a factor level.

Note: I assigned the filtered gapminder data to a new dataframe "newgap" to assist in the comparisons between newgap and the original gapminder dataset later on in this assignment.

***

For now, let's **remove the unused factor level** Oceania:

```{r Drop levels}
#change to character
newgap$continent <- as.character(newgap$continent)

#change back to factor
newgap$continent <- as.factor(newgap$continent)

#check if it worked
levels(newgap$continent)
```

In my own data analysis I've dropped unusued levels by changing the factor to a character, where "Oceania" is not found and then changing it back to a factor to attain the new levels. But as with all data manipulation and coding problems, there are other solutions that can be used, such as droplevels() or fct_drop().

***

Provide concrete **information on the data** before and after removing these rows and Oceania; address the number of rows and the levels of the affected factors:

```{r Data info}
#how many rows in original
nrow(gapminder)

#how many rows once modified
nrow(newgap)

#how many rows were deleted
nrow(gapminder) - nrow(newgap)

#number of levels in original
nlevels(gapminder$continent)

#number of levels once modified
nlevels(newgap$continent)
```

Comparing the original and the filtered data we see that there are 24 rows of Oceania values that were removed. (And even though I could have mentally figured out that 1704-1680=24, I still decided to make R do the hard work for us!) Also we see that we went from 5 levels to 4, with the continents Americas, Asia, Africa and Europe remaining after the removal of Oceania.

***

Reorder the levels of country or continent. Use the forcats package to change the order of the factor levels, based on a principled summary of one of the quantitative variables. Consider experimenting with a **summary statistic** beyond the most basic choice of the median:

```{r Summary statistic}
#find continents with max life exp. and put in numerical order
maxgap <- newgap %>%
  group_by(continent) %>%
  summarize(maxlife=max(lifeExp)) %>%
  arrange(desc(maxlife))

#make a table for the max life exp.
knitr::kable(maxgap, format="markdown")
```

I will **reorder my factors** according to which continents have the highest life expectancy, i.e. who lives the longest.

```{r Reorder levels}
fct_reorder(newgap$continent, newgap$lifeExp, max, .desc=TRUE) %>%
  levels()
```

I've previously done factor reordering with this code:

`newgap$continent <- factor(newgap$continent, levels(newgap$continent)[c(3, 4, 2, 1)])`

to manually rearrange the levels, the numbers indicating the previous ordering, which is why I thought I needed the table to find what order the new levels needed to be in. However, forcats does it all automatically for me! Table not needed but I still find helpful for confirming the correct order.

### File I/O

### Visualization design

### Writing figures to file